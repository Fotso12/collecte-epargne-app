<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Dashboard Caissier</h1>
    <div class="user-info">
      <p><strong>{{ dashboard.nomCaissier }}</strong></p>
      <p class="agence">{{ dashboard.agenceNom }}</p>
    </div>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <div *ngIf="isLoading" class="spinner">
    <p>Chargement...</p>
  </div>

  <div *ngIf="!isLoading" class="dashboard-content">
    <!-- KPIs Cards -->
    <div class="kpi-container">
      <div class="kpi-card bg-primary">
        <div class="kpi-value">{{ dashboard.transactionsEnAttente }}</div>
        <div class="kpi-label">Transactions en Attente</div>
      </div>

      <div class="kpi-card bg-success">
        <div class="kpi-value">{{ dashboard.transactionsValideeAujourdhui }}</div>
        <div class="kpi-label">Validées Aujourd'hui</div>
      </div>

      <div class="kpi-card bg-info">
        <div class="kpi-value">{{ formatMontant(dashboard.montantValideAujourd) }}</div>
        <div class="kpi-label">Montant Validé (Jour)</div>
      </div>

      <div class="kpi-card bg-warning">
        <div class="kpi-value">{{ formatMontant(dashboard.gainsJourCaissier) }}</div>
        <div class="kpi-label">Mes Gains (Jour)</div>
      </div>
    </div>

    <!-- Secondary KPIs -->
    <div class="secondary-kpi">
      <div class="secondary-kpi-item">
        <span class="label">Clients Totaux:</span>
        <span class="value">{{ dashboard.clientsTotal }}</span>
      </div>
      <div class="secondary-kpi-item">
        <span class="label">Collecteurs Actifs:</span>
        <span class="value">{{ dashboard.collecteursTotal }}</span>
      </div>
      <div class="secondary-kpi-item">
        <span class="label">Montant Total Validé:</span>
        <span class="value">{{ formatMontant(dashboard.montantValideTotal) }}</span>
      </div>
      <div class="secondary-kpi-item">
        <span class="label">Transactions Totales:</span>
        <span class="value">{{ dashboard.transactionsTotal }}</span>
      </div>
    </div>

    <!-- Top Collecteurs -->
    <div class="section">
      <h2>Top Collecteurs</h2>
      <div *ngIf="dashboard.topCollecteurs && dashboard.topCollecteurs.length > 0" class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th>Nom Collecteur</th>
              <th>Montant Collecté</th>
              <th>Clients</th>
              <th>Transactions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let collecteur of dashboard.topCollecteurs">
              <td>{{ collecteur.nomCollecteur }}</td>
              <td>{{ formatMontant(collecteur.montantCollecte) }}</td>
              <td>{{ collecteur.nombreClients }}</td>
              <td>{{ collecteur.nombreTransactions }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="!dashboard.topCollecteurs || dashboard.topCollecteurs.length === 0" class="no-data">
        Aucun collecteur disponible
      </div>
    </div>

    <!-- Dernières Transactions -->
    <div class="section">
      <h2>Dernières Transactions</h2>
      <div *ngIf="dashboard.derniereTransactions && dashboard.derniereTransactions.length > 0" class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th>Référence</th>
              <th>Montant</th>
              <th>Client</th>
              <th>Collecteur</th>
              <th>Statut</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let transaction of dashboard.derniereTransactions">
              <td>{{ transaction.reference }}</td>
              <td>{{ formatMontant(transaction.montant) }}</td>
              <td>{{ transaction.client }}</td>
              <td>{{ transaction.collecteur }}</td>
              <td>
                <span [ngClass]="'status-' + transaction.statusValidation">
                  {{ transaction.statusValidation }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="!dashboard.derniereTransactions || dashboard.derniereTransactions.length === 0" class="no-data">
        Aucune transaction disponible
      </div>
    </div>
  </div>
</div>
